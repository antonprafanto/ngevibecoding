---
import BaseLayout from './BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import TOC from '../components/ui/TOC.astro';

export interface Props {
  title: string;
  description?: string;
  frontmatter?: {
    title: string;
    order: number;
    duration: string;
    level: string;
    summary: string;
  };
  headings?: Array<{
    depth: number;
    slug: string;
    text: string;
  }>;
  nextModule?: {
    title: string;
    slug: string;
  };
  prevModule?: {
    title: string;
    slug: string;
  };
}

const { title, description, frontmatter, headings = [], nextModule, prevModule } = Astro.props;
---

<BaseLayout title={title} description={description}>
  <Navbar />
  
  <main class="min-h-screen bg-gray-50 dark:bg-gray-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Breadcrumbs -->
      <nav class="mb-8" aria-label="Breadcrumb">
        <ol class="flex items-center space-x-2 text-sm">
          <li>
            <a href="/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300">
              Home
            </a>
          </li>
          <li>
            <svg class="w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
            </svg>
          </li>
          <li>
            <a href="/modules" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300">
              Modul
            </a>
          </li>
          <li>
            <svg class="w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
            </svg>
          </li>
          <li class="text-gray-900 dark:text-white font-medium">
            {frontmatter?.title || title}
          </li>
        </ol>
      </nav>

      <!-- Module Header -->
      {frontmatter && (
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8">
          <div class="flex items-start justify-between mb-4">
            <div class="flex-1">
              <h1 class="font-heading text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2">
                {frontmatter.title}
              </h1>
              <p class="text-lg text-gray-600 dark:text-gray-300 mb-4">
                {frontmatter.summary}
              </p>
            </div>
            <div class="ml-6 flex-shrink-0">
              <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-2xl">
                {frontmatter.order}
              </div>
            </div>
          </div>
          
          <div class="flex flex-wrap items-center gap-4 text-sm">
            <div class="flex items-center text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              {frontmatter.duration}
            </div>
            <div class="flex items-center text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              {frontmatter.level}
            </div>
          </div>
        </div>
      )}

      <!-- Content Layout -->
      <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <!-- Main Content -->
        <div class="lg:col-span-3">
          <article class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 md:p-8">
            <div class="content max-w-none text-gray-900 dark:text-gray-100 leading-relaxed">
              <slot />
            </div>
          </article>
        </div>

        <!-- Sidebar -->
        <div class="lg:col-span-1">
          {headings.length > 0 && <TOC headings={headings} />}
        </div>
      </div>

      <!-- Navigation -->
      <div class="mt-12 flex flex-col sm:flex-row justify-between items-center gap-4">
        {prevModule && (
          <a 
            href={`/modules/${prevModule.slug}`}
            class="group flex items-center px-6 py-3 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-white rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 transition-colors"
          >
            <svg class="w-5 h-5 mr-3 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"></path>
            </svg>
            <div class="text-left">
              <div class="text-xs text-gray-500 dark:text-gray-400">Sebelumnya</div>
              <div class="font-medium">{prevModule.title}</div>
            </div>
          </a>
        )}

        {!prevModule && <div></div>}

        {nextModule && (
          <a 
            href={`/modules/${nextModule.slug}`}
            class="group flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg shadow-sm transition-colors"
          >
            <div class="text-right">
              <div class="text-xs text-blue-100">Selanjutnya</div>
              <div class="font-medium">{nextModule.title}</div>
            </div>
            <svg class="w-5 h-5 ml-3 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
            </svg>
          </a>
        )}
      </div>
    </div>
  </main>

  <Footer />
</BaseLayout>

<style>
  /* Custom styles for better typography */
  .prose h2[id], .prose h3[id], .prose h4[id] {
    scroll-margin-top: 6rem;
  }
  
  .prose h2[id]:before, .prose h3[id]:before, .prose h4[id]:before {
    content: '';
    display: block;
    height: 6rem;
    margin-top: -6rem;
  }
</style>